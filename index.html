<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DERMATO — Your AI Skin Health Partner</title>
  <meta name="description" content="DERMATO — a polished, student-built demo for an AI dermatology assistant (SDG 3). Frontend only. Not medical advice."/>
  <meta name="theme-color" content="#0a1b33">
  <meta property="og:title" content="DERMATO — AI-Powered Dermatology" />
  <meta property="og:description" content="Smart skin care, backed by AI. Demo UI only. Not medical advice." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0%25' stop-color='%23d9b65d'/%3E%3Cstop offset='100%25' stop-color='%23f4e3b1'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='256' height='256' fill='%230a1b33'/%3E%3Ccircle cx='128' cy='128' r='86' fill='url(%23g)'/%3E%3Cpath d='M106 164c22 14 56 3 56-28 0-20-14-36-36-36h-22v64h2z' fill='none' stroke='%230a1b33' stroke-width='10' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/ svg%3E" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    /* --------- Brand Tokens --------- */
    :root{
      --navy-950:#081225;
      --navy-900:#0a1b33;
      --navy-800:#0f2544;
      --navy-700:#173256;
      --gold-600:#c9a33b;
      --gold-500:#d9b65d;
      --gold-400:#f0db96;
      --sand-200:#e9ecf3;
      --text-100:#f7f9fe;
      --text-300:#cdd6e9;
      --border:rgba(255,255,255,.14);
      --muted:rgba(255,255,255,.06);
      --glass:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      --shadow-lg:0 16px 40px rgba(0,0,0,.35);
      --shadow-md:0 10px 24px rgba(0,0,0,.28);
      --radius:18px;
      --focus:0 0 0 3px rgba(217,182,93,.35), 0 0 0 6px rgba(217,182,93,.15);
    }

    /* --------- Base --------- */
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{
      background:
        radial-gradient(1200px 700px at 15% -10%, rgba(240,219,150,.10), transparent 60%),
        linear-gradient(180deg, var(--navy-950), var(--navy-900));
      color:var(--text-100);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      line-height:1.6;
      min-height:100dvh;
      text-rendering:optimizeLegibility;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{width:min(1160px,92%);margin-inline:auto}
    .headline{font-family:"Playfair Display", Georgia, "Times New Roman", serif;font-weight:700;font-size:clamp(2.2rem,4vw,3.2rem);letter-spacing:.2px;margin:0 0 .4rem}
    .subhead{color:var(--text-300);margin:.35rem 0 1.25rem}

    /* --------- Accessibility --------- */
    :focus-visible{outline:none;box-shadow:var(--focus);border-radius:12px}
    @media (prefers-reduced-motion:reduce){
      *{animation-duration:.001ms !important;animation-iteration-count:1 !important;transition-duration:0.01ms !important;scroll-behavior:auto !important}
    }

    /* --------- Nav --------- */
    .navbar{position:sticky;top:0;z-index:50;background:rgba(10,27,51,.7);backdrop-filter:blur(10px);border-bottom:1px solid var(--border)}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;min-height:72px}
    .brand{display:flex;align-items:center;gap:.8rem;font-weight:700;letter-spacing:.4px}
    .brand svg{flex:0 0 auto}
    .brand .wordmark{font-weight:700;font-size:1.05rem;letter-spacing:.12em;text-transform:uppercase}
    .brand .wordmark b{letter-spacing:.14em;background:linear-gradient(180deg, var(--gold-500), var(--gold-400));-webkit-background-clip:text;background-clip:text;color:transparent}
    .nav-toggle{display:none;background:transparent;border:0}
    .nav-toggle .bar{display:block;width:22px;height:2px;background:var(--text-100);margin:5px 0;border-radius:2px}
    .nav-menu{display:flex;gap:.2rem}
    .nav-menu a{padding:.6rem .9rem;border-radius:999px;border:1px solid transparent;color:var(--text-300)}
    .nav-menu a:hover{background:rgba(255,255,255,.06);border-color:var(--border);color:var(--text-100)}
    .nav-menu a.active{color:var(--text-100);border-color:rgba(217,182,93,.35);background:rgba(217,182,93,.10)}

    /* --------- Buttons & UI --------- */
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:.55rem;padding:.9rem 1.15rem;border-radius:14px;border:1px solid var(--border);background:rgba(255,255,255,.04);color:var(--text-100);box-shadow:var(--shadow-md);transition:transform .15s ease,filter .15s ease,background .15s ease}
    .btn:hover{transform:translateY(-1px);filter:brightness(1.04)}
    .btn:active{transform:translateY(0)}
    .btn-primary{background:linear-gradient(180deg, var(--gold-500), var(--gold-400));color:#0b1f3a;border:none}
    .btn-ghost{background:transparent;border-color:var(--border)}
    .btn-small{padding:.6rem .85rem;border-radius:11px}
    .chip{display:inline-flex;align-items:center;gap:.4rem;padding:.5rem .75rem;border-radius:999px;border:1px solid var(--border);background:rgba(255,255,255,.05);cursor:pointer;user-select:none;transition:background .15s ease,border-color .15s ease}
    .chip.active{background:rgba(217,182,93,.16);border-color:rgba(217,182,93,.35)}

    .card{background:var(--glass);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow-lg);padding:1.1rem}

    /* --------- Sections --------- */
    .hero{padding:72px 0 28px}
    .hero-inner{display:grid;grid-template-columns:1.15fr .85fr;gap:2.2rem;align-items:center}
    .cta{display:flex;gap:.8rem;flex-wrap:wrap}
    .trust{display:flex;gap:1.2rem;align-items:center;margin-top:1rem;color:var(--text-300);font-size:.95rem}
    .features{padding:16px 0 40px}
    .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:1.2rem}
    .about{padding:28px 0 72px}
    .footer{border-top:1px solid var(--border);padding:18px 0;background:rgba(10,27,51,.65);backdrop-filter:blur(8px)}
    .footer-inner{display:flex;flex-direction:column;gap:.25rem;align-items:center;text-align:center}

    /* --------- Chat --------- */
    .page-head{padding:44px 0 14px}
    .chat-wrap{padding:14px 0 72px}
    .chat{display:flex;flex-direction:column;gap:12px}
    .chat-window{height:400px;overflow:auto;padding:1rem;background:rgba(0,0,0,.15);border:1px solid var(--border);border-radius:14px}
    .msg{display:flex;margin:.25rem 0}
    .msg .bubble{padding:.65rem .85rem;border-radius:12px;max-width:75%;background:rgba(255,255,255,.06);border:1px solid var(--border)}
    .msg.user{justify-content:flex-end}
    .msg.user .bubble{background:rgba(217,182,93,.16);border-color:rgba(217,182,93,.35)}
    .chat-input{display:flex;gap:.6rem;flex-wrap:wrap}
    .chat-input input[type="text"]{flex:1;min-width:220px;padding:.85rem;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text-100)}
    .note{color:var(--text-300);margin:0 .2rem}

    .uploader{display:grid;grid-template-columns:1fr;gap:.75rem}
    .upload-row{display:flex;gap:.6rem;flex-wrap:wrap;align-items:center}
    .preview{display:flex;gap:.8rem;align-items:center}
    .preview img{width:86px;height:86px;object-fit:cover;border-radius:12px;border:1px solid var(--border)}
    .meter{height:10px;border-radius:999px;background:rgba(255,255,255,.1);position:relative;overflow:hidden}
    .meter>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--gold-500), var(--gold-400))}

    /* --------- Hero Tagline Rotator --------- */
    .rotator{min-height:2.1em;display:inline-block;position:relative}
    .rotator span{position:absolute;inset:0;opacity:0;transform:translateY(8px);transition:opacity .5s ease, transform .5s ease}
    .rotator span.active{opacity:1;transform:translateY(0)}

    /* --------- Responsive --------- */
    @media(max-width: 980px){.hero-inner{grid-template-columns:1fr}}
    @media(max-width: 760px){
      .nav-toggle{display:block}
      .nav-menu{position:absolute;top:72px;left:0;right:0;display:none;flex-direction:column;background:rgba(10,27,51,.97);border-bottom:1px solid var(--border)}
      .nav-menu.open{display:flex}
      .nav-menu a{padding:1rem 1.1rem;border-bottom:1px solid var(--border)}
      .grid-3{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <header class="navbar">
    <div class="container nav-inner">
      <a class="brand" href="#home" aria-label="DERMATO Home">
        <!-- Pro SVG Logo: shield + monogram D with subtle skin curve -->
        <svg width="30" height="30" viewBox="0 0 64 64" aria-hidden="true" role="img">
          <defs>
            <linearGradient id="lg" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#d9b65d"/>
              <stop offset="100%" stop-color="#f0db96"/>
            </linearGradient>
          </defs>
          <path d="M8 10c0 18 8 31 24 38c16-7 24-20 24-38l-24-6l-24 6z" fill="url(#lg)" stroke="#0a1b33" stroke-width="2"/>
          <path d="M24 46c10 6 24 1 24-12c0-9-6-16-16-16h-12v28h4z" fill="none" stroke="#0a1b33" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M26 26c6 4 12 4 16 0" fill="none" stroke="#0a1b33" stroke-opacity=".8" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span class="wordmark"><b>DERMATO</b></span>
      </a>
      <button class="nav-toggle" aria-expanded="false" aria-controls="nav-menu" aria-label="Toggle navigation">
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
      </button>
      <nav id="nav-menu" class="nav-menu" aria-label="Primary">
        <a href="#home" class="active">Home</a>
        <a href="#chatbot">Chatbot</a>
        <a href="#about">About</a>
      </nav>
    </div>
  </header>

  <main id="home">
    <section class="hero">
      <div class="container hero-inner">
        <div class="hero-copy">
          <h1 class="headline">Dermato – Your AI Skin Health Partner</h1>
          <p class="subhead" aria-live="polite">
            <span class="rotator" id="tagRotator" aria-label="Rotating taglines">
              <!-- Rotating lines injected by JS; fallback shown here -->
              <span class="active">Smart Skin Care, Backed by AI</span>
            </span>
          </p>
          <div class="cta">
            <a class="btn btn-primary" href="#chatbot">Start chat</a>
            <a class="btn btn-ghost" href="#about">Learn more</a>
          </div>
          <div class="trust" aria-hidden="true">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Frontend demo • No medical advice • SDG 3 aligned
          </div>
        </div>
        <div class="card" style="padding:1.2rem 1.1rem 1.3rem">
          <div class="card-header" style="font-weight:600;margin-bottom:.35rem">Demo flow</div>
          <div class="card-body">
            <ul class="preview-list" style="margin:.2rem 0 1rem; padding-left:1.1rem">
              <li>Upload an image (local preview only)</li>
              <li>Select symptom chips & duration</li>
              <li>Get a simulated suggestion</li>
              <li>Open Maps to find clinics</li>
            </ul>
            <a class="btn btn-ghost btn-small" href="#chatbot">Try it</a>
          </div>
        </div>
      </div>
    </section>

    <section class="features">
      <div class="container grid-3">
        <article class="feature card">
          <h3>Simple upload</h3>
          <p>Client-side compression & preview to keep things smooth. No data leaves your browser.</p>
        </article>
        <article class="feature card">
          <h3>Guided questions</h3>
          <p>Toggle common symptoms, add duration/severity, and get a clear next-step suggestion.</p>
        </article>
        <article class="feature card">
          <h3>Clinic Finder</h3>
          <p>Uses your device location (with permission) to open dermatologists nearby in Google Maps.</p>
        </article>
      </div>
    </section>

    <section id="chatbot" class="page-head">
      <div class="container">
        <h2 class="headline">Chatbot</h2>
        <p class="subhead">Demo only. This simulates how the AI will respond based on your inputs.</p>
      </div>
    </section>

    <section class="chat-wrap">
      <div class="container">
        <div class="chat card">
          <div class="uploader">
            <div class="upload-row">
              <input id="file" type="file" accept="image/*" />
              <button class="btn btn-ghost btn-small" id="clearImg" type="button">Clear image</button>
              <span id="imgInfo" aria-live="polite"></span>
            </div>
            <div class="preview" id="preview" hidden>
              <img id="thumb" alt="Uploaded preview"/>
              <div>
                <div class="meter" aria-hidden="true"><span id="qMeter"></span></div>
                <small class="subhead">Preview quality estimate</small>
              </div>
            </div>
          </div>

          <div class="symptoms card">
            <div style="display:flex;gap:.5rem;flex-wrap:wrap">
              <span class="chip" data-s="redness">Redness</span>
              <span class="chip" data-s="itching">Itching</span>
              <span class="chip" data-s="pain">Pain</span>
              <span class="chip" data-s="dryness">Dryness</span>
              <span class="chip" data-s="pimples">Pimples</span>
              <span class="chip" data-s="rash">Rash</span>
            </div>
            <div style="display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.6rem">
              <label>Duration (days): <input id="dur" type="number" min="0" step="1" value="1" style="width:88px;padding:.4rem .55rem;border-radius:10px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text-100)"></label>
              <label>Severity (1–10): <input id="sev" type="number" min="1" max="10" step="1" value="3" style="width:88px;padding:.4rem .55rem;border-radius:10px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text-100)"></label>
              <button id="analyze" class="btn btn-primary btn-small" type="button">Analyze</button>
              <button id="findClinics" class="btn btn-ghost btn-small" type="button">Find nearby clinics</button>
              <button id="clearChat" class="btn btn-ghost btn-small" type="button">Clear history</button>
            </div>
          </div>

          <div class="chat-window" id="chat" role="log" aria-live="polite">
            <div class="msg bot"><div class="bubble">Hi! I’m Dermato. Add a photo (optional), choose symptoms, and press <em>Analyze</em>. I’ll simulate suggestions. For real concerns, consult a dermatologist.</div></div>
          </div>

          <form class="chat-input" onsubmit="return false" aria-label="Chat input">
            <input id="text" type="text" placeholder="Type a message to add context (optional)"/>
            <button class="btn btn-primary" id="send" type="button">Send</button>
          </form>

          <p class="note">Disclaimer: This is a student demo UI. It does not provide medical advice or diagnosis.</p>
        </div>
      </div>
    </section>

    <section id="about" class="about">
      <div class="container">
        <div class="card">
          <h2>About</h2>
          <p>This front‑end showcases the intended flow for an AI dermatology assistant aligned with SDG 3. It uses simulated logic only; no data leaves your browser unless you open Google Maps for clinics.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer-inner">
      <p>© <span id="year"></span> DERMATO</p>
      <p><small>UI: classic navy & gold • Frontend demo only</small></p>
    </div>
  </footer>

  <script>
    // ===== Navbar toggle =====
    const toggle = document.querySelector('.nav-toggle');
    const menu = document.querySelector('#nav-menu');
    if (toggle && menu){
      toggle.addEventListener('click', () => {
        const open = menu.classList.toggle('open');
        toggle.setAttribute('aria-expanded', String(open));
      });
    }

    // ===== Active nav on scroll =====
    const links = document.querySelectorAll('.nav-menu a');
    function setActiveLink(){
      const fromTop = window.scrollY + 90;
      links.forEach(link => {
        const sec = document.querySelector(link.getAttribute('href'));
        if (!sec) return;
        if (sec.offsetTop <= fromTop && sec.offsetTop + sec.offsetHeight > fromTop){
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });
    }
    window.addEventListener('scroll', setActiveLink);
    setActiveLink();

    // ===== Footer year =====
    document.getElementById('year').textContent = new Date().getFullYear();

    // ===== Rotating taglines =====
    const taglines = [
      'Smart Skin Care, Backed by AI',
      'From Symptoms to Solutions — Instantly',
      'Your Skin, Our AI Expertise',
      'Find Answers. Feel Better. Faster.',
      'AI-Powered Dermatology, Anytime, Anywhere',
      'Healthy Skin Starts with Dermato',
      'Scan. Detect. Treat.'
    ];

    const rotHost = document.getElementById('tagRotator');

    function renderRotator(lines){
      rotHost.innerHTML = '';
      lines.forEach((t, i) => {
        const span = document.createElement('span');
        span.textContent = t;
        if (i === 0) span.classList.add('active');
        rotHost.appendChild(span);
      });
    }

    renderRotator(taglines);

    let idx = 0;
    setInterval(() => {
      const children = rotHost.querySelectorAll('span');
      if (!children.length) return;
      children[idx].classList.remove('active');
      idx = (idx + 1) % children.length;
      children[idx].classList.add('active');
    }, 2600);

    // ===== Chat helpers =====
    const chat = document.getElementById('chat');
    function addMsg(role, text){
      const wrap = document.createElement('div');
      wrap.className = 'msg ' + (role === 'user' ? 'user' : 'bot');
      const b = document.createElement('div');
      b.className = 'bubble';
      b.innerHTML = text;
      wrap.appendChild(b);
      chat.appendChild(wrap);
      chat.scrollTop = chat.scrollHeight;
      saveHistory();
    }

    // ===== Local history =====
    function saveHistory(){ localStorage.setItem('dermato_history', chat.innerHTML); }
    function loadHistory(){
      const h = localStorage.getItem('dermato_history');
      if (h) chat.innerHTML = h;
    }
    loadHistory();

    // ===== Chips (symptoms) =====
    const selected = new Set();
    document.querySelectorAll('.chip').forEach(ch => {
      ch.addEventListener('click', () => {
        const key = ch.dataset.s;
        if (selected.has(key)){ selected.delete(key); ch.classList.remove('active'); }
        else { selected.add(key); ch.classList.add('active'); }
      });
    });

    // ===== Text send =====
    document.getElementById('send').addEventListener('click', () => {
      const t = document.getElementById('text');
      if (!t.value.trim()) return;
      addMsg('user', t.value);
      setTimeout(() => addMsg('bot', 'Noted. I will consider that context when analyzing your inputs.'), 300);
      t.value='';
    });

    // ===== Image upload + preview + simple compression =====
    const fileInput = document.getElementById('file');
    const thumb = document.getElementById('thumb');
    const preview = document.getElementById('preview');
    const info = document.getElementById('imgInfo');
    const qMeter = document.getElementById('qMeter');

    function humanSize(bytes){
      const units = ['B','KB','MB','GB']; let i=0, n=bytes;
      while(n>=1024 && i<units.length-1){ n/=1024; i++; }
      return n.toFixed(1)+' '+units[i];
    }

    function estimateQuality(w,h){ // naive estimate for preview only
      const pixels = w*h;
      const pct = Math.max(10, Math.min(100, (pixels/ (900*900))*100));
      return pct;
    }

    fileInput.addEventListener('change', async (e) => {
      const f = e.target.files[0];
      if (!f) return;
      const url = URL.createObjectURL(f);
      const img = new Image();
      img.onload = () => {
        // Draw to canvas to create a thumbnail (no upload)
        const canvas = document.createElement('canvas');
        const maxSide = 280;
        const scale = Math.min(1, maxSide/Math.max(img.width, img.height));
        canvas.width = Math.round(img.width*scale);
        canvas.height = Math.round(img.height*scale);
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        thumb.src = canvas.toDataURL('image/jpeg', 0.82);
        preview.hidden = false;
        info.textContent = `Selected: ${f.name} • ${humanSize(f.size)} • ${img.width}×${img.height}`;
        const q = estimateQuality(img.width, img.height);
        qMeter.style.width = q + '%';
        URL.revokeObjectURL(url);
        addMsg('user', 'Uploaded an image for analysis (preview only).');
      };
      img.src = url;
    });

    document.getElementById('clearImg').addEventListener('click', () => {
      fileInput.value = '';
      thumb.removeAttribute('src');
      preview.hidden = true;
      info.textContent = '';
      addMsg('user','Cleared the image.');
    });

    // ===== Simulated analysis =====
    function generateSuggestion(symSet, duration, severity){
      const s = Array.from(symSet);
      const d = Number(duration)||0;
      const sev = Number(severity)||1;
      let base = [];
      if (s.includes('pimples') || s.includes('redness')) base.push('acne-like irritation');
      if (s.includes('rash')) base.push('dermatitis');
      if (s.includes('dryness')) base.push('dry skin/eczema');
      if (s.includes('itching')) base.push('allergic reaction');
      if (s.includes('pain')) base.push('inflamed lesion');
      if (base.length===0) base.push('a minor skin irritation');

      const risk = (sev>=7 || d>=7) ? 'moderate' : (sev>=4 || d>=3) ? 'low-to-moderate' : 'low';
      const care = [
        'cleanse gently; avoid harsh scrubs',
        'apply a light, non-comedogenic moisturizer',
        'use sunscreen (SPF 30+) daily',
      ];
      if (s.includes('itching')) care.push('consider calamine lotion or a mild antihistamine (OTC, label-directed)');
      if (s.includes('dryness')) care.push('use fragrance-free moisturizer with ceramides');
      if (s.includes('pimples')) care.push('spot-treat with 2.5% benzoyl peroxide or 0.5–1% salicylic acid');
      if (s.includes('redness')) care.push('avoid new cosmetics for 48h; keep skin barrier care');
      if (s.includes('pain')) care.push('avoid popping/squeezing; apply cool compress 5–10 min');

      const follow = risk==='moderate'
        ? 'Consider seeing a dermatologist, especially if spreading, painful, or with fever.'
        : 'Monitor for changes; seek a professional if symptoms worsen.';

      return `I see signs consistent with <b>${base.join(' / ')}</b> (risk: <b>${risk}</b>). Suggested care: <ul>${care.map(c=>`<li>${c}</li>`).join('')}</ul>${follow}`;
    }

    document.getElementById('analyze').addEventListener('click', () => {
      const d = document.getElementById('dur').value;
      const sev = document.getElementById('sev').value;
      addMsg('user', `Analyze my inputs. Symptoms: <code>${Array.from(selected).join(', ')||'none'}</code>; duration: ${d}d; severity: ${sev}/10.`);
      // Fake "thinking"
      const thinking = document.createElement('div');
      thinking.className='msg bot';
      thinking.innerHTML = '<div class="bubble">Analyzing…</div>';
      chat.appendChild(thinking); chat.scrollTop = chat.scrollHeight;
      setTimeout(() => {
        thinking.remove();
        const suggestion = generateSuggestion(selected, d, sev);
        addMsg('bot', suggestion + '<br><small class="subhead">This is a demo and not medical advice.</small>');
      }, 600);
    });

    // ===== Maps: nearby dermatologists =====
    document.getElementById('findClinics').addEventListener('click', () => {
      if ('geolocation' in navigator){
        navigator.geolocation.getCurrentPosition(pos => {
          const {latitude, longitude} = pos.coords;
          const url = `https://www.google.com/maps/search/dermatologist/@${latitude},${longitude},14z`;
          window.open(url, '_blank', 'noopener');
          addMsg('bot', 'Opened Google Maps with dermatologists near your location.');
        }, () => {
          window.open('https://www.google.com/maps/search/dermatologist', '_blank', 'noopener');
          addMsg('bot', 'Opened Google Maps search for dermatologists (location permission denied).');
        }, {enableHighAccuracy:true, timeout:8000});
      } else {
        window.open('https://www.google.com/maps/search/dermatologist', '_blank', 'noopener');
        addMsg('bot', 'Opened Google Maps search for dermatologists (geolocation not available).');
      }
    });

    // ===== Clear history =====
    document.getElementById('clearChat').addEventListener('click', () => {
      chat.innerHTML = '<div class="msg bot"><div class="bubble">History cleared. Start again by adding an image or selecting symptoms.</div></div>';
      saveHistory();
    });
  </script>
</body>
</html>
